const axios = require('axios'); 

exports.handler = function(context, event, callback) {
    let twiml = new Twilio.twiml.MessagingResponse();

    console.log("I got called, here is the message body:");
    console.log(event.Body);

    axios.post('https://yourawslambdaAPIURLhere/prod/ask', {
        body: event.Body
    })
    .then(res => {
        console.log('Message sent to OpenAI API: ', event.Body);  // Logs the prompt sent to OpenAI
        console.log('API Response: ', res.data);  // Logging the API response
        let message = JSON.parse(res.data.body).message;  // Extract message from JSON
        twiml.message(message);
        callback(null, twiml);
    })
    .catch(err => {
        console.log('Error: ', err);  // Logging any errors
        callback("Sorry, something went wrong");
    });
};
